------------------------------------------Networking -------------------------------------------------------------

VPC is a virtual network or dataset inside AWS for a specific client
Flat in a building but can't go inside other flat
logical isolated
Max 5 VPC in a Region
200 subnets in a VPC
200 routing table
Max 5 Elastic IP in an account (may be extend based on request to AWS)

when we create a VPC the by default below is created automatically
1) DHCP
2) Security Group
3) NACL

VPC is created in a Region and not in AZs
its all properties are regional

can't use same CIDR in other VPC in the same region
but for VPC peering (communicate) both CIDR should be different

Subnet is created in AZ and not in regions
A same subnet can't be used on two AZ

Can a VPC extends to two diff AZs 
No

Can a Subnet exits in two diff AZs 
No

Once a VPC is created, you can't change its CIDR block range

--------------------------
Physical Addressing

MAC address 48 bits

Logical Addressing
eg my home address
IP address
IPv4 and  IPv6

IPv4
Public IP and Private IP

32 bit logical address
4 Octet
0 to 255 max value in each octet

IP address = Network ID + Host ID

8 bits  8 bits  8 bits  8 bits 

Large Network
Class A  1.0.0.0 to 126.0.0.0
N H H H 

Class B  128.0.0.0 to 191.255.0.0
N N H H 
Small Network
Class C  192.0.0.0 to 223.255.255.0
N N N H 

Class D  224-239 multi cast4
Class E  240-255 research

Loop Back Address
127.0.0.0 to check network interface

To find network ID

Network bit = 1
Host bit 		 = 0

eg.
115 .0 .0.15
Class A
one oct et is reserved
115.0.0.0  is become the network id

196.10.10.10
then its network id will be 
196.10.10.0

Give IP address find its subnet mask

115.10.10.20
Class A
255 0 0 0 0 subnet mask

160.10.10.20
Class B
255.255 0 .0 is subnet mask

Private IP for LAN no need to buy, can't got to router or internet
Class A 
10

Class B
172.16 to 172.31

Class C
192168.0.0 to 192.168.255.255

Q: 150 10 20 30
Class B
150 10 0 0 Network Id (Identifier of the network)
150 10 255 255 broadcast IP
2 (h) - 2 = 2(16) - 2 = 65534 usable computers can be attached

if both IPs results in same network IP then it means that these are part of same network

Subneting 
network within a network
or locally division of IP addresses

Router interfaces
A different network must be on an Router Interface with diff network ID

router is internet-working device
b/w multiple networks

switch is b/w same network communication

130 10 0  0
		  1
		 2
		 255
130 10 1  0				 
130 10 2  0				 

subnet mask = cidr

A = /8
B = /16
C  = /24   24 bits for Network

OTHER WISE there is Subneting
give host bits to network is called Subneting
dividing  big network into small networks is called Subneting


eg
192  168    1     3      class C  (3N  and1H)
255   255 255  0       subnet mask 
Network address of this will be then 
192   168   1    0       (255= same and 0 = 0)

very good read its screen shots
https://www.youtube.com/watch?v=q7wNcYliJ1Q


CIDR is classless Inter domain routing
A method for allocating IP addresses 

It is as also a 32-bit address, which includes a special number which represents the number of bits that are present in the Block Id.
a . b . c . d / n 
Where, n is number of bits that are present in Block Id / Network Id.
how many bits are turned as 1s


CIDR is 8 for class A by default
CIDR is 16 for class B by default
CIDR is 24 for class C by default  (3N  and1H)
-------------------------------------------------------------------------------------------------------------------

Creating own private network in the cloud
your own isolated network (traffic not visible to other AWS vps)
you can control all the traffic coming in and out a VPC
Best practice all resources from ur VPC

To separate public resource (accessible through internet) with private resources 

create public subnet for public resources and like private
public resources can talk to private 

Each VPC is associated with a Region
each subnet is created in AZ

eg VPC = us-east-1
Subnets = us-east-1a,us-east-1b

VPC -> 
default VPC always created without a name
default subnets also created 

No. of subnets = No. of AZ

IPv4  32 bit  (allows 4.3 billion address) most popular
127.255.255.255

IPv6  128 bit alphanumeric

182.82.143.132/32 is a single ip 
0.0.0.0/0 all

10.88.135.144/30
means
2 rasie power (32 -30) = 4 

Each VPChttp://localhost:7080/mep/services/pcs.ctos.lock.unlock.invoice.ext is associated with a CIDR block
CIDR b;lock can be from /16 (65536 ) to /28 (16) IP addresses

VPC with CIDR block 69.208.0.0/24  69.208.0.0 to 69.208.0.255 

There can't be an overlap of a VPC CIDR block with another connected network

All addresses inside a VPC CIDR range are private addresses
Sbunet resides in VPC

CIDR block of a subnet must be a subset or the same as CIDR block for VPC

Can VPC spread over two regions ?
No

Multiple VPC in same region 
Yes  (default vpc and custom vpc)

Communication b/w tow resources in a VPC is visible outside VPC
No

Can we allow External access to your resources in a VPC
Yes (using Internet Gateway)

Can a subnet spread over two regions ?
No, since subnet is part of VPC and VPC is associated with a single Region

Can a subnet spread over two Availability Zones
No, A subnet is specific to a particular AZ

Can I have 2 subnets in one AZ
Yes , 

Can I have subnet in AZ ap-south-1a if its VPC is in region us-east-1
No, subnet should be on AZ belonging to the VPC's region


VPC Main route table

1) each VPC when created has a main route table by default (enable communication b/w resources in all subnets in a VPC)
2)default roye rule can't be deleted/edited

3)Each subnet can have its route table or share its route tale with VPC
4) Multiple subnets can share a route table
5) A subnet can be associated with one route table ONLY

Security Groups

1) a default SG is created when we created a VPC
allows all outbound traffic
allows communication b/r resources assigned with default security grop
Denies all other in bound (other than default SG)
can be edited but not deleted
EC2 instance by default are assigned  the default security group of the VPC
Security Group can have many to many relationship with Resources (in same VPC)

New security  group
by default No in bound rule
allows all outbound traffic

ssh : 22
rdp : 8889
HTTP :80
HTTPS  :443
PostgreSQL/Aurora :5432
Oracle :1521
MySQL/Aurora/Maria DB :3306
MSSQL  Server:1433
FTP : 21
SFTP : 22


1) Can source/destination of a SG be another SG
Yes

2) A new SG is created and assigned to a DB and EC2
they can't talk as SG doesn't allow inbound traffic by default

3) A default SG is created and assigned to a DB and EC2
they CAN talk as SG has a rule allowing traffic b/w resources with same SG

NACL Network Access Control Listener
SG control traffic to specific resources like EC2 ina subnet
NACL control traffic stopping even entering the subnet
stateless firewall at subnet level
Each subnet must be associated with NACL
default NACL allows all inbound and outbound traffic
custom crated NACL denies all inbound and outbound traffic by default
rules have priory no. (lower has high value)

Security Groups
only allow rules
stateful, return traffic is automatically allowed
traffic allowed if there is matching rule

NACL 
allow rules and deny rules
stateless, explicitly allow return traffic
rules are priority , matching rule with highest priority


Traffic from outside subnet then NACL will intercept
Traffic within Subnet SG will intercept

Imp Scenario

EC2 instance can't be accessed from internet
1) does EC2 have public IP address or an Elastic IP assigned
2) Check NACL, is inbound and outbound traffic allowed from your IP to the port
3) Check route table for the subnet, is there a route to internet gateway
if it a private subnet then can't
4) Check Security group, all u allowing inbound traffic from ur IP to the port

AWS Service to allow instances in private subnet to connect to internet to download patches
is using NAT Gateway

A VPC cannot have multiple Internet Gateways

